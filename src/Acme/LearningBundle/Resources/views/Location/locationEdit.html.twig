{% extends '::mobile-base.html.twig' %}

{% block pageId %}editLocation{% endblock %}

{% block scripts %}
<script type="text/javascript" src="{{ asset('js/googleMaps.mobile.js') }}"></script>
{% endblock %}

{% block header %}
{% if app.session.hasFlash('success') %}
	<div data-role="header" data-theme="e" class="ui-header ui-bar-e" role="banner">
		<h1 class="ui-title" tabindex="0" role="heading" aria-level="1">{{ app.session.flash('success') }}</h1>
	</div>
{% else %}
{{ parent() }}
{% endif %}
{% endblock %}

{% block content%}
<form action="{{ path('AcmeLearningBundle_editLocation' , { 'id' : id }) }}" method="post" {{ form_enctype(form) }}>
    {{ form_widget(form) }}
    <span class="note">select the marker to point a position</span>
	<button type="submit" data-theme="a" class="ui-btn-hidden" aria-disabled="false">Submit</button>
	<button type="submit" name="action" value="delete" data-role="button" data-icon="delete">Delete</button>
</form>
<div id="map_canvas" style="width: 100%;height: 200px;"></div>
<script>
var map,marker;
$(function() { 
	if($("#form_lat").val() && $("#form_lng").val()){
		var center = new google.maps.LatLng($("#form_lat").val(), $("#form_lng").val());
	} else {
		var center = new google.maps.LatLng(-34.397, 150.644);
	}
	var myOptions = {
		center: center,zoom: 15,mapTypeId: google.maps.MapTypeId.ROADMAP
	};
	map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
	marker = new google.maps.Marker({position: center,map: map,title:"Here"});
   google.maps.event.addListener(map, 'click', function(event) {
		var myLatLng = event.latLng;var lat = myLatLng.lat();var lng = myLatLng.lng();
		var pos = new google.maps.LatLng(lat,lng);
		marker.setPosition(pos);
		$("#form_lat").val(lat);
      $("#form_lng").val(lng);
	});
});
</script>
{% endblock %}